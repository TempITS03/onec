Процедура ПриУстановкеНовогоНомераДокументаПриУстановкеНовогоНомера(Источник, СтандартнаяОбработка, Префикс) Экспорт
	
	ОбщегоНазначения.ДобавитьПрефиксОрганизации(Источник, Префикс);
	
КонецПроцедуры

Процедура ПриУстановкиПометкиУдаленияНаЗаданиеПередУдалением(Источник, Отказ) Экспорт
	
	Источник.Выгружен = Ложь;
	
КонецПроцедуры


Процедура ПередЗаписьюРегламентногоЗаданияПередЗаписью(Источник, Отказ, РежимЗаписи, РежимПроведения) Экспорт
	
	//при установке пометки удаления необходимо пометить прикрепленные файлы
	
	Запрос = Новый Запрос("ВЫБРАТЬ
	|	ХранимыеФайлы.Ссылка
	|ИЗ
	|	Справочник.ХранимыеФайлы КАК ХранимыеФайлы
	|ГДЕ
	|	ХранимыеФайлы.ОбъектДанных = &ОбъектДанных
	|");
	
	Запрос.УстановитьПараметр("ОбъектДанных",Источник.Ссылка);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		ХранимыеФайлы = Выборка.Ссылка.ПолучитьОбъект();
		ХранимыеФайлы.ПометкаУдаления = Источник.ПометкаУдаления;
		ХранимыеФайлы.Записать();
	КонецЦикла;	
	
КонецПроцедуры


Процедура ПриОтменеПроведенияРегламентногоЗаданияОбработкаУдаленияПроведения(Источник, Отказ) Экспорт
	
	Источник.Выгружен = Ложь;
	
КонецПроцедуры

