
&НаСервереБезКонтекста
Процедура ЗаполнениеДокументовдатойСдачиРабот()
	
	Запрос = Новый Запрос("ВЫБРАТЬ РАЗРЕШЕННЫЕ
	                      |	ЭтапыРешений.Ссылка,
	                      |	ЭтапыРешений.ДатаИсполнения,
	                      |	ЭтапыРешений.НомерСтроки,
	                      |	ЭтапыРешений.Ссылка.ДатаСдачиРабот
	                      |ИЗ
	                      |	Документ.РегламентноеЗадание.ТиповыеРешения КАК ЭтапыРешений
	                      |ГДЕ
	                      |	ЭтапыРешений.Ссылка.Проведен
	                      |	И ЭтапыРешений.Ссылка.Состояние = ЗНАЧЕНИЕ(Перечисление.СостояниеЗаданий.Завершено)
	                      |	И ЭтапыРешений.ДатаИсполнения = ДАТАВРЕМЯ(1, 1, 1)
	                      |
	                      |СГРУППИРОВАТЬ ПО
	                      |	ЭтапыРешений.Ссылка,
	                      |	ЭтапыРешений.ДатаИсполнения,
	                      |	ЭтапыРешений.НомерСтроки");
	
 	РезЗапр = Запрос.Выполнить().Выгрузить();
	
	Для Каждого СтрокаОбъекта Из РезЗапр Цикл
		
		ДокОбъект = СтрокаОбъекта.Ссылка.ПолучитьОбъект();
		
		ТЧ_Этапы = ДокОбъект.ТиповыеРешения;
		
		СтрокаТЧ = ТЧ_Этапы.Получить(СтрокаОбъекта.НомерСтроки-1);
		СтрокаТЧ.ДатаИсполнения = СтрокаОбъекта.ДатаСдачиРабот;
		
		ДокОбъект.Записать();
		
	КонецЦикла;	
	
КонецПроцедуры	

&НаКлиенте
Процедура ЗаполнитьДатойСдачиРабот(Команда)
	
	ЗаполнениеДокументовдатойСдачиРабот();
	
КонецПроцедуры
