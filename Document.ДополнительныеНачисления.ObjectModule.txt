
Процедура ОбработкаПроведения(Отказ, Режим)
	
	//Сбор остатков
	Запрос = Новый Запрос("ВЫБРАТЬ
	|	ДополнительныеНачисленияПлатежи.Ссылка.Организация,
	|	ДополнительныеНачисленияПлатежи.Сотрудник,
	|	ДополнительныеНачисленияПлатежи.ВидРасчета,
	|	ДополнительныеНачисленияПлатежи.Валюта,
	|	СУММА(ДополнительныеНачисленияПлатежи.Сумма) КАК Сумма
	|ИЗ
	|	Документ.ДополнительныеНачисления.Платежи КАК ДополнительныеНачисленияПлатежи
	|ГДЕ
	|	ДополнительныеНачисленияПлатежи.Ссылка = &Ссылка
	|
	|СГРУППИРОВАТЬ ПО
	|	ДополнительныеНачисленияПлатежи.Ссылка.Организация,
	|	ДополнительныеНачисленияПлатежи.Сотрудник,
	|	ДополнительныеНачисленияПлатежи.ВидРасчета,
	|	ДополнительныеНачисленияПлатежи.Валюта");
		
	Запрос.УстановитьПараметр("Ссылка",Ссылка);
	
	Результат = Запрос.Выполнить().Выгрузить();
	Результат.Колонки.Добавить("Период");
	Результат.Колонки.Добавить("ВидДвижения");
	
	Результат.ЗаполнитьЗначения(Дата,"Период");
	Результат.ЗаполнитьЗначения(ВидДвиженияНакопления.Приход,"ВидДвижения");
	
	// Создание движения в регистре накопления  РасчетыССотрудниками
	Движения.РасчетыССотрудниками.Записывать = Истина;
	Движения.РасчетыССотрудниками.Загрузить(Результат);

	
КонецПроцедуры
